<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Edit Sheet</title>
		<link rel="stylesheet" href="styles/styles.css" />
		<link rel="stylesheet" href="styles/edit.css" />
		<script>
			window.serverDepartments = <%- JSON.stringify(departments || []) %>;
		</script>
		<script type="module" src="js/edit.js" defer></script>
	</head>
	<body>
		<header>
			<nav class="navigation-bar">
				<h1>Green River College</h1>
				<button id="sign-in-button">Sign in</button>
			</nav>
		</header>
		<main>
			<form id="page-form" class="content-container" action="" method="get">
				<!-- Master Edit Form Buttons -->
				<div class="form-edit-container">
					<button type="button" id="edit-form-btn" style="display: none">
						Edit Form
					</button>
					<button type="button" id="save-form-btn" style="display: none">
						Save Form
					</button>
					<button type="button" id="cancel-form-btn" style="display: none">
						Cancel
					</button>
					<button type="button" id="add-program-btn" style="display: none">
						Add a Program
					</button>
				</div>

				<fieldset id="div-select-set" class="top-section fieldset">
					<label for="division-select">Choose a Division</label>
					<select name="division" id="division-select">
						<option value="">-- Select division --</option>
						<% if (departments && departments.length) {
						departments.forEach(function (d) { %>
						<option
							value="<%= d.divisionName %>"
							data-dean="<%= d.deanName %>"
							data-pen="<%= d.penContact %>"
							data-loc="<%= d.locRep %>"
							data-chair="<%= d.chairName %>"
						>
							<%= d.divisionName %>
						</option>
						<% }); } %>
					</select>

					<label for="dean-input">Dean: </label>
					<input type="text" id="dean-input" disabled />

					<label for="pen-input">PEN Contact: </label>
					<input type="text" id="pen-input" disabled />

					<label for="loc-input">LOC Representative: </label>
					<input type="text" id="loc-input" disabled />

					<label for="chair-input">Chair: </label>
					<input type="text" id="chair-input" disabled />
				</fieldset>

				<section id="programs-container" class="container">
					<% if (departments && departments.length) {
					departments.forEach(function (division) {
					division.programList.forEach(function (p) { %>
					<fieldset
						class="program"
						id="<%= p.programName %>-program"
						style="display: none"
					>
						<p class="p-title"><%= p.programName %></p>

						<section class="payee-container program-sections">
							<% let payeeIndex = 1; for (const [name, amount] of
							Object.entries(p.payees)) { %>
							<div class="payee-item">
								<label>Payee #<%= payeeIndex %></label>
								<div class="program-payee-input-section grid">
									<input type="text" value="<%= name %>" disabled />
									<input type="number" value="<%= amount %>" disabled />
									<button
										type="button"
										class="remove-payee-btn"
										disabled
										style="<%= Object.keys(p.payees).length ? '' : 'display:none' %>"
									>
										Remove
									</button>
								</div>
							</div>
							<% payeeIndex++; } %>
							<button type="button" class="add-payee-btn" disabled>
								Add Payee
							</button>
						</section>

						<fieldset class="program-money-section">
							<div>
								<label>Has been paid</label>
								<input type="checkbox" <%= p.hasBeenPaid ? "checked" : "" %>
								disabled />
							</div>
							<div>
								<label>Submitted</label>
								<input type="checkbox" <%= p.reportSubmitted ? "checked" : "" %>
								disabled />
							</div>
						</fieldset>

						<fieldset class="program-notes-section">
							<label>Notes</label>
							<textarea disabled><%= p.notes %></textarea>
						</fieldset>

						<button type="button" class="remove-program-btn" disabled>
							Remove
						</button>
					</fieldset>
					<% }); }); } %>
				</section>
			</form>
		</main>
	</body>
</html>
